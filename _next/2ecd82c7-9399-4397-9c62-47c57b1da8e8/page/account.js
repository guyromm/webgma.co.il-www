module.exports=__NEXT_REGISTER_PAGE("/account",function(){var e=webpackJsonp([11],{442:function(e,t,n){e.exports=n(443)},443:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:true});n.d(t,"LinkAccounts",function(){return C});n.d(t,"LinkAccount",function(){return N});var a=n(8);var r=n.n(a);var i=n(0);var s=n.n(i);var o=n(210);var l=n.n(o);var u=n(21);var c=n.n(u);var m=n(252);var p=n.n(m);var f=n(22);var h=n(206);var d=n.n(h);var v=n(13);var y=n(11);var b=n(220);var E=n.n(b);var g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};var k=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||false;a.configurable=true;"value"in a&&(a.writable=true);Object.defineProperty(e,a.key,a)}}return function(t,n,a){n&&e(t.prototype,n);a&&e(t,a);return t}}();var w=function e(t,n,a){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,a)}if("value"in r)return r.value;var s=r.get;if(void 0===s)return;return s.call(a)};function x(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:true,configurable:true,writable:true}):e[t]=n;return e}function _(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(r,i){try{var s=t[r](i);var o=s.value}catch(e){n(e);return}if(!s.done)return Promise.resolve(o).then(function(e){a("next",e)},function(e){a("throw",e)});e(o)}return a("next")})}}function O(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function S(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function P(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:false,writable:true,configurable:true}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var j=function(e){P(t,e);k(t,null,[{key:"getInitialProps",value:function(){var e=_(r.a.mark(function e(n){var a=n.req;var i;return r.a.wrap(function e(n){while(1)switch(n.prev=n.next){case 0:n.next=2;return w(t.__proto__||Object.getPrototypeOf(t),"getInitialProps",this).call(this,{req:a});case 2:i=n.sent;n.next=5;return h["NextAuth"].linked({req:a});case 5:i.linkedAccounts=n.sent;return n.abrupt("return",i);case 7:case"end":return n.stop()}},e,this)}));function n(t){return e.apply(this,arguments)}return n}()}]);function t(e){O(this,t);var n=S(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={session:e.session,isSignedIn:!!e.session.user,name:"",email:"",emailVerified:false,alertText:null,alertStyle:null};if(e.session.user){n.state.name=e.session.user.name;n.state.email=e.session.user.email}n.handleChange=n.handleChange.bind(n);n.onSubmit=n.onSubmit.bind(n);return n}k(t,[{key:"componentDidMount",value:function(){var e=_(r.a.mark(function e(){var t,n;return r.a.wrap(function e(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return h["NextAuth"].init({force:true});case 2:t=a.sent;this.setState({session:t,isSignedIn:!!t.user});n=new E.a;n.set("redirect_url",window.location.pathname,{path:"/"});this.getProfile();case 7:case"end":return a.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},{key:"getProfile",value:function e(){var t=this;p()("/account/user",{credentials:"include"}).then(function(e){return e.json()}).then(function(e){if(!e.name||!e.email)return;t.setState({name:e.name,email:e.email,emailVerified:e.emailVerified})})}},{key:"handleChange",value:function e(t){this.setState(x({},t.target.name,t.target.value))}},{key:"onSubmit",value:function(){var e=_(r.a.mark(function e(t){var n=this;var a,i;return r.a.wrap(function e(s){while(1)switch(s.prev=s.next){case 0:t.preventDefault();this.setState({alertText:null,alertStyle:null});s.next=4;return h["NextAuth"].csrfToken();case 4:s.t0=s.sent;s.t1=this.state.name||"";s.t2=this.state.email||"";a={_csrf:s.t0,name:s.t1,email:s.t2};i=Object.keys(a).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(a[e])}).join("&");p()("/account/user",{credentials:"include",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i}).then(function(){var e=_(r.a.mark(function e(t){return r.a.wrap(function e(a){while(1)switch(a.prev=a.next){case 0:if(!(200===t.status)){a.next=11;break}n.getProfile();n.setState({alertText:"Changes to your profile have been saved",alertStyle:"alert-success"});a.t0=n;a.next=6;return h["NextAuth"].init({force:true});case 6:a.t1=a.sent;a.t2={session:a.t1};a.t0.setState.call(a.t0,a.t2);a.next=17;break;case 11:a.t3=n;a.next=14;return h["NextAuth"].init({force:true});case 14:a.t4=a.sent;a.t5={session:a.t4,alertText:"Failed to save changes to your profile",alertStyle:"alert-danger"};a.t3.setState.call(a.t3,a.t5);case 17:case"end":return a.stop()}},e,n)}));return function(t){return e.apply(this,arguments)}}());case 10:case"end":return s.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()},{key:"render",value:function e(){if(true===this.state.isSignedIn){var t=null===this.state.alertText?s.a.createElement("div",null):s.a.createElement("div",{className:"alert "+this.state.alertStyle,role:"alert"},this.state.alertText);return s.a.createElement(y["a"],g({},this.props,{navmenu:false}),s.a.createElement(f["r"],{className:"mb-1"},s.a.createElement(f["b"],{xs:"12"},s.a.createElement("h1",{className:"display-2"},"Your Account"),s.a.createElement("p",{className:"lead text-muted"},"Edit your profile and link accounts"))),t,s.a.createElement(f["r"],{className:"mt-4"},s.a.createElement(f["b"],{xs:"12",md:"8",lg:"9"},s.a.createElement(f["e"],{method:"post",action:"/account/user",onSubmit:this.onSubmit},s.a.createElement(f["g"],{name:"_csrf",type:"hidden",value:this.state.session.csrfToken,onChange:function e(){}}),s.a.createElement(f["f"],{row:true},s.a.createElement(f["h"],{sm:2},"Name:"),s.a.createElement(f["b"],{sm:10,md:8},s.a.createElement(f["g"],{name:"name",value:this.state.name,onChange:this.handleChange}))),s.a.createElement(f["f"],{row:true},s.a.createElement(f["h"],{sm:2},"Email:"),s.a.createElement(f["b"],{sm:10,md:8},s.a.createElement(f["g"],{name:"email",value:this.state.email.match(/.*@localhost\.localdomain$/)?"":this.state.email,onChange:this.handleChange}))),s.a.createElement(f["f"],{row:true},s.a.createElement(f["b"],{sm:12,md:10},s.a.createElement("p",{className:"text-right"},s.a.createElement(f["a"],{color:"primary",type:"submit"},"Save Changes")))))),s.a.createElement(f["b"],{xs:"12",md:"4",lg:"3"},s.a.createElement(C,{session:this.props.session,linkedAccounts:this.props.linkedAccounts}))),s.a.createElement(f["r"],null,s.a.createElement(f["b"],null,s.a.createElement("h2",null,"Delete your account"),s.a.createElement("p",null,"If you delete your account it will be erased immediately. You can sign up again at any time."),s.a.createElement(f["e"],{id:"signout",method:"post",action:"/account/delete"},s.a.createElement("input",{name:"_csrf",type:"hidden",value:this.state.session.csrfToken}),s.a.createElement(f["a"],{type:"submit",color:"outline-danger"},s.a.createElement("span",{className:"icon ion-md-trash mr-1"})," Delete Account")))))}return s.a.createElement(y["a"],g({},this.props,{navmenu:false}),s.a.createElement(f["r"],null,s.a.createElement(f["b"],{xs:"12",className:"text-center pt-5 pb-5"},s.a.createElement("p",{className:"lead m-0"},s.a.createElement(c.a,{href:"/auth"},s.a.createElement("a",null,"Sign in to manage your profile"))))))}}]);return t}(v["a"]);t["default"]=j;var C=function(e){P(t,e);function t(){O(this,t);return S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}k(t,[{key:"render",value:function e(){var t=this;return s.a.createElement(s.a.Fragment,null,Object.keys(this.props.linkedAccounts).map(function(e,n){return s.a.createElement(N,{key:n,provider:e,session:t.props.session,linked:t.props.linkedAccounts[e]})}))}}]);return t}(s.a.Component);var N=function(e){P(t,e);function t(){O(this,t);return S(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}k(t,[{key:"render",value:function e(){return true===this.props.linked?s.a.createElement("form",{method:"post",action:"/auth/oauth/"+this.props.provider.toLowerCase()+"/unlink"},s.a.createElement("input",{name:"_csrf",type:"hidden",value:this.props.session.csrfToken}),s.a.createElement("p",null,s.a.createElement("button",{className:"btn btn-block btn-outline-danger",type:"submit"},"Unlink from ",this.props.provider))):s.a.createElement("p",null,s.a.createElement("a",{className:"btn btn-block btn-outline-primary",href:"/auth/oauth/"+this.props.provider.toLowerCase()},"Link with ",this.props.provider))}}]);return t}(s.a.Component)}},[442]);return{page:e.default}});